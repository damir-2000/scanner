(function(e){function t(t){for(var n,c,l=t[0],s=t[1],u=t[2],d=0,p=[];d<l.length;d++)c=l[d],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&p.push(o[c][0]),o[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);i&&i(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,l=1;l<r.length;l++){var s=r[l];0!==o[s]&&(n=!1)}n&&(a.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},o={app:0},a=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="static/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var i=s;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23");function o(e,t,r,o,a,c){var l=Object(n["resolveComponent"])("router-view");return Object(n["openBlock"])(),Object(n["createBlock"])(l)}var a=r("5530"),c=r("5502"),l={methods:Object(a["a"])({},Object(c["b"])({})),computed:Object(a["a"])({},Object(c["c"])({})),mounted:function(){}},s=r("d959"),u=r.n(s);const i=u()(l,[["render",o]]);var d=i,p=r("6c02"),m=(r("d3b7"),r("d4ec")),b=r("bee2"),O=(r("e9c4"),r("bc3a")),f=r.n(O),h=r("1232"),j=function(){function e(){Object(m["a"])(this,e),this.client=f.a.create({baseURL:"api/"}),this.token=window.localStorage.getItem("token"),this.token&&(this.client.defaults.headers.common["Authorization"]="Bearer ".concat(JSON.parse(this.token).access))}return Object(b["a"])(e,[{key:"loginUser",value:function(e){var t=this;return this.client.post("token/",e).then((function(e){var r=e.data;return window.localStorage.setItem("token",JSON.stringify(r)),t.client.defaults.headers.common["Authorization"]="Bearer ".concat(e.data.access),{status:e.status,userData:Object(h["a"])(e.data.access)}})).catch((function(e){return{status:e.response.status,userData:""}}))}},{key:"registrationUser",value:function(e){return this.client.post("registration",e).then((function(e){return{status:e.status,userData:e.data}})).catch((function(e){return{status:e.response.status,userData:e.response.data}}))}},{key:"logout",value:function(){window.localStorage.removeItem("token"),this.client.defaults.headers.common["Authorization"]="",this.token=""}},{key:"updateToken",value:function(){var e=this,t=JSON.parse(window.localStorage.getItem("token")).refresh;return this.client.post("token/refresh/",{refresh:t}).then((function(t){var r=t.data;return window.localStorage.setItem("token",JSON.stringify(r)),e.client.defaults.headers.common["Authorization"]="Bearer ".concat(t.data.access),{status:t.status,userData:Object(h["a"])(t.data.access)}})).catch((function(e){return{status:e.response.status,userData:""}}))}},{key:"existToken",value:function(){var e=window.localStorage.getItem("token");return!!e}},{key:"groupList",value:function(){return this.client.get("/group_list").then((function(e){return{status:e.status,groupList:e.data}})).catch((function(e){return{status:e.response.status,groupList:""}}))}}]),e}(),g=new j,v=Object(c["a"])({state:{userData:{},isAuth:!1},mutations:{setIsAuth:function(e,t){e.isAuth=t},setUserData:function(e,t){e.userData=t}},actions:{login:function(e,t){return g.loginUser(t).then((function(t){var r=t.status,n=t.userData;return 200==r&&(e.commit("setIsAuth",!0),e.commit("setUserData",n)),t}))},registration:function(e,t){return g.registrationUser(t)},logout:function(e){g.logout(),e.commit("setIsAuth",!1),e.commit("setUserData",{})},isAuthorized:function(e){return!!e.state.isAuth||(g.existToken()?g.updateToken().then((function(t){var r=t.status,n=t.userData;return 200==r&&(e.commit("setIsAuth",!0),e.commit("setUserData",n),!0)})):new Promise((function(e){e(!1)})))},groupList:function(){return g.groupList()}},modules:{}}),N=r("cf05"),V=r.n(N),E={class:"home"},w=Object(n["createElementVNode"])("img",{alt:"Vue logo",src:V.a},null,-1),y=Object(n["createElementVNode"])("a",{href:"/logout"},"Выйти",-1),k=[w,y];function D(e,t,r,o,a,c){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",E,k)}var x={name:"Home",components:{}};const I=u()(x,[["render",D]]);var S=I,T=Object(n["createElementVNode"])("nav",null,[Object(n["createElementVNode"])("ul",null,[Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("a",{href:"/logout"},"Выйти")])])],-1),R={class:"error"},L={class:"decode-result"},P=Object(n["createTextVNode"])(" Last result: ");function U(e,t,r,o,a,c){var l=Object(n["resolveComponent"])("qrcode-stream");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[T,Object(n["createElementVNode"])("p",R,Object(n["toDisplayString"])(a.error),1),Object(n["createElementVNode"])("p",L,[P,Object(n["createElementVNode"])("b",null,Object(n["toDisplayString"])(a.result),1)]),Object(n["createVNode"])(l,{onDecode:c.onDecode,onInit:c.onInit,class:"stream"},null,8,["onDecode","onInit"])],64)}var B=r("1da1"),A=(r("96cf"),r("b0c0"),r("474b")),M={name:"Scanner",components:{QrcodeStream:A["QrcodeStream"]},data:function(){return{result:"",error:""}},methods:{onDecode:function(e){console.log(),this.result=e},onInit:function(e){var t=this;return Object(B["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e;case 3:r.next=8;break;case 5:r.prev=5,r.t0=r["catch"](0),"NotAllowedError"===r.t0.name?t.error="ERROR: you need to grant camera access permission":"NotFoundError"===r.t0.name?t.error="ERROR: no camera on this device":"NotSupportedError"===r.t0.name?t.error="ERROR: secure context required (HTTPS, localhost)":"NotReadableError"===r.t0.name?t.error="ERROR: is the camera already in use?":"OverconstrainedError"===r.t0.name?t.error="ERROR: installed cameras are not suitable":"StreamApiNotSupportedError"===r.t0.name?t.error="ERROR: Stream API is not supported in this browser":"InsecureContextError"===r.t0.name?t.error="ERROR: Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":t.error="ERROR: Camera error (".concat(r.t0.name,")");case 8:case"end":return r.stop()}}),r,null,[[0,5]])})))()}}};r("ecf5");const _=u()(M,[["render",U]]);var z=_,C=Object(n["createElementVNode"])("nav",null,[Object(n["createElementVNode"])("ul",null,[Object(n["createElementVNode"])("li",null,[Object(n["createElementVNode"])("a",{href:"/logout"},"Выйти")])])],-1);function H(e,t,r,o,a,c){var l=Object(n["resolveComponent"])("qrcode-vue");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[C,Object(n["createVNode"])(l,{value:a.value,size:a.size,level:"H","render-as":"svg"},null,8,["value","size"]),Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("p",null," Фамилия: "+Object(n["toDisplayString"])(e.userData.last_name),1),Object(n["createElementVNode"])("p",null," Имя: "+Object(n["toDisplayString"])(e.userData.first_name),1),Object(n["createElementVNode"])("p",null," Группа: "+Object(n["toDisplayString"])(e.userData.group),1)])],64)}var J=r("d39c"),G=r.n(J),F={data:function(){return{value:"https://example.com",size:300}},components:{QrcodeVue:G.a},computed:Object(a["a"])({},Object(c["c"])({userData:"userData"})),mounted:function(){console.log(this.userData)}};const q=u()(F,[["render",H]]);var Q=q,$=Object(n["createTextVNode"])("Зарегистрироваться"),K=Object(n["createElementVNode"])("label",{for:"loginInput"},"Логин",-1),W=Object(n["createTextVNode"])(),X=Object(n["createElementVNode"])("br",null,null,-1),Y=Object(n["createElementVNode"])("label",{for:"passwordInput"},"Пароль",-1),Z=Object(n["createTextVNode"])(),ee=Object(n["createElementVNode"])("br",null,null,-1),te=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("input",{type:"submit",value:"Войти"})],-1);function re(e,t,r,o,a,c){var l=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((function(){return c.auth&&c.auth.apply(c,arguments)}),["prevent"]))},[Object(n["createElementVNode"])("p",null,[Object(n["createVNode"])(l,{to:"/registration"},{default:Object(n["withCtx"])((function(){return[$]})),_:1})]),Object(n["createElementVNode"])("p",null,[K,W,X,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"loginInput","onUpdate:modelValue":t[0]||(t[0]=function(e){return a.userLogin=e}),type:"text",placeholder:"Логин"},null,512),[[n["vModelText"],a.userLogin]])]),Object(n["createElementVNode"])("p",null,[Y,Z,ee,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"passwordInput","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.userPassword=e}),type:"password",placeholder:"Пароль"},null,512),[[n["vModelText"],a.userPassword]])]),te],32)}var ne={data:function(){return{userLogin:"",userPassword:""}},methods:Object(a["a"])(Object(a["a"])({},Object(c["b"])({login:"login"})),{},{auth:function(){var e=this;""!=this.userLogin&&""!=this.userPassword&&this.login({username:this.userLogin,password:this.userPassword}).then((function(t){var r=t.status;200==r?(console.log("acces"),console.log(t),e.$router.push("/")):401==r&&console.log("unacces")}))}}),mounted:function(){}};const oe=u()(ne,[["render",re]]);var ae=oe,ce=Object(n["createTextVNode"])("Войти"),le=Object(n["createElementVNode"])("label",{for:"firstNameInput"},"Имя",-1),se=Object(n["createTextVNode"])(),ue=Object(n["createElementVNode"])("br",null,null,-1),ie=Object(n["createElementVNode"])("label",{for:"lastNameInput"},"Фамилия",-1),de=Object(n["createTextVNode"])(),pe=Object(n["createElementVNode"])("br",null,null,-1),me=Object(n["createElementVNode"])("label",{for:"groupInput"},"Группа",-1),be=Object(n["createTextVNode"])(),Oe=Object(n["createElementVNode"])("br",null,null,-1),fe=["value"],he=Object(n["createElementVNode"])("label",{for:"emailInput"},"Email",-1),je=Object(n["createTextVNode"])(),ge=Object(n["createElementVNode"])("br",null,null,-1),ve=Object(n["createElementVNode"])("label",{for:"loginInput"},"Логин",-1),Ne=Object(n["createTextVNode"])(),Ve=Object(n["createElementVNode"])("br",null,null,-1),Ee=Object(n["createElementVNode"])("label",{for:"passwordInput"},"Пароль",-1),we=Object(n["createTextVNode"])(),ye=Object(n["createElementVNode"])("br",null,null,-1),ke=Object(n["createElementVNode"])("label",{for:"repeaPasswordInput"},"Повторите пароль",-1),De=Object(n["createTextVNode"])(),xe=Object(n["createElementVNode"])("br",null,null,-1),Ie=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("input",{type:"submit",value:"Зарегистрироваться"})],-1);function Se(e,t,r,o,a,c){var l=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("form",{onSubmit:t[7]||(t[7]=Object(n["withModifiers"])((function(){return c.resgistration&&c.resgistration.apply(c,arguments)}),["prevent"]))},[Object(n["createElementVNode"])("p",null,[Object(n["createVNode"])(l,{to:"/login"},{default:Object(n["withCtx"])((function(){return[ce]})),_:1})]),Object(n["createElementVNode"])("p",null,[le,se,ue,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"firstNameInput","onUpdate:modelValue":t[0]||(t[0]=function(e){return a.firstName=e}),type:"text",placeholder:"Имя"},null,512),[[n["vModelText"],a.firstName]])]),Object(n["createElementVNode"])("p",null,[ie,de,pe,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"lastNameInput","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.lastName=e}),type:"text",placeholder:"Фамилия"},null,512),[[n["vModelText"],a.lastName]])]),Object(n["createElementVNode"])("p",null,[me,be,Oe,Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{id:"groupInput","onUpdate:modelValue":t[2]||(t[2]=function(e){return a.group=e})},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.selectGroupList,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:e.id,value:e.id},Object(n["toDisplayString"])(e.name),9,fe)})),128))],512),[[n["vModelSelect"],a.group]])]),Object(n["createElementVNode"])("p",null,[he,je,ge,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"emailInput","onUpdate:modelValue":t[3]||(t[3]=function(e){return a.email=e}),type:"email",placeholder:"Email"},null,512),[[n["vModelText"],a.email]])]),Object(n["createElementVNode"])("p",null,[ve,Ne,Ve,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"loginInput","onUpdate:modelValue":t[4]||(t[4]=function(e){return a.userLogin=e}),type:"text",placeholder:"Логин"},null,512),[[n["vModelText"],a.userLogin]])]),Object(n["createElementVNode"])("p",null,[Ee,we,ye,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"passwordInput","onUpdate:modelValue":t[5]||(t[5]=function(e){return a.userPassword=e}),type:"password",placeholder:"Пароль"},null,512),[[n["vModelText"],a.userPassword]])]),Object(n["createElementVNode"])("p",null,[ke,De,xe,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{id:"repeaPasswordInput","onUpdate:modelValue":t[6]||(t[6]=function(e){return a.repeatUserPassword=e}),type:"password",placeholder:"Повторите пароль"},null,512),[[n["vModelText"],a.repeatUserPassword]])]),Ie],32)}var Te={data:function(){return{firstName:"",lastName:"",group:"",userLogin:"",email:"",userPassword:"",repeatUserPassword:"",selectGroupList:[]}},methods:Object(a["a"])(Object(a["a"])({},Object(c["b"])({registration:"registration",groupList:"groupList"})),{},{resgistration:function(){var e=this;""!=this.userLogin&&""!=this.userPassword&&""!=this.firstName&&""!=this.lastName&&""!=this.group&&""!=this.email&&this.registration({username:this.userLogin,password:this.userPassword,first_name:this.firstName,last_name:this.lastName,group:this.group,email:this.email}).then((function(t){"success"==t.userData.status&&e.$router.push("/login")}))}}),mounted:function(){var e=this;this.groupList().then((function(t){e.selectGroupList=t.groupList,console.log(e.selectGroupList)}))}};const Re=u()(Te,[["render",Se]]);var Le=Re,Pe=[{path:"/",name:"Home",component:S},{path:"/scanner",name:"Scanner",component:z},{path:"/generator",name:"Generator",component:Q},{path:"/login",name:"Login",component:ae},{path:"/registration",name:"Registration",component:Le}],Ue=Object(p["a"])({history:Object(p["b"])(),routes:Pe});Ue.beforeEach((function(e,t,r){console.log(e),console.log(t),v.dispatch("isAuthorized").then((function(t){if("/logout"==e.path)v.dispatch("logout"),r("/");else if(t&&"/login"!=e.path&&"/registration"!=e.path||!t&&("/login"==e.path||"/registration"==e.path)){var n,o,a;console.log(null===(n=v.state.userData)||void 0===n?void 0:n.role),null!==(o=v.state.userData)&&void 0!==o&&o.role&&-1!=v.state.userData.role.indexOf("user")&&"/generator"!=e.path?r("/generator"):null!==(a=v.state.userData)&&void 0!==a&&a.role&&-1!=v.state.userData.role.indexOf("scanner")&&"/scanner"!=e.path?r("/scanner"):r()}else r(t?"/":"/login")}))}));var Be=Ue;Object(n["createApp"])(d).use(v).use(Be).mount("#app")},a3f2:function(e,t,r){},cf05:function(e,t,r){e.exports=r.p+"img/logo.82b9c7a5.png"},ecf5:function(e,t,r){"use strict";r("a3f2")}});
//# sourceMappingURL=app.44b6a164.js.map